<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>The Chi : Cinematic Roleplay</title>
<style>
  :root{
    --bg:#0b0b12;
    --panel:#121421;
    --accent:#ff6b3b;
    --accent-2:#ffb03a;
    --text:#e8e8f2;
    --muted:#94a3b8;
    --card-common:#2b2f44;
    --shadow:0 10px 30px rgba(0,0,0,.45);
    --player-height:62px; /* used by the player UI */
  }
  *{box-sizing:border-box}
  html,body{height:100%; overflow-x:hidden}
  body{
    margin:0;background:radial-gradient(1200px 600px at 10% -10%, rgba(255,140,64,.16), transparent 60%),
    radial-gradient(1200px 600px at 110% 10%, rgba(255,92,48,.12), transparent 60%), var(--bg);
    color:var(--text); font:500 16px/1.4 "Rajdhani", system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
    letter-spacing:.2px; display:flex; align-items:flex-start; justify-content:center; padding:0px 16px calc(var(--player-height) + 48px);
  }

  /* revert to original page background (your animated GIF + overlay image) */
  .page-bg{
    position:fixed;
    inset:0;
    z-index:0;
    pointer-events:none;
    background:
      url('https://i.ibb.co/qMm7TKMz/The-Deadly-War-Between-Bloodhound-And-Risky-Road.gif') center/cover no-repeat fixed,
      url('https://i.imgur.com/z17MUhQ.png') center/cover no-repeat fixed;
    filter: blur(12px) saturate(1.08);
    opacity:.23;
    transform: scale(1.06);
  }

  /* removed the <video> background element (we're using the GIF background again) */

  .wrap{max-width:1280px; width:100%; margin:0 auto}
  .topbar {
    position: sticky; top: 0; z-index: 100;
    background: linear-gradient(180deg, rgba(10,10,16,0.95), rgba(10,10,16,0.7));
    border-bottom: 1px solid rgba(255,255,255,0.06);
    backdrop-filter: blur(8px) saturate(1.2);
  }
  .top-inner { max-width: 1280px; margin: 0 auto; padding: 14px 22px; display: flex; align-items: center; justify-content: space-between;}
  .brand { font-size: clamp(20px, 3vw, 28px); font-weight: 800; color: #fff; letter-spacing: 0.02em; margin: 0; }
  .brand .accent { color: var(--accent-2); text-shadow: 0 0 10px rgba(255,176,58,0.40);}
  .nav { display: flex; align-items: center; gap: 18px; }
  .nav-link { color: #d8dee9; font-size: 14px; text-decoration: none; transition: color 0.2s ease, text-shadow 0.2s ease; }
  .nav-link:hover { color: var(--accent-2); text-shadow: 0 0 8px rgba(255,176,58,0.40);}
  .nav-section { display: none;}
  .nav-section.active { display: block;}
  .section-card { background: var(--panel); border-radius:14px; box-shadow:var(--shadow); padding: 30px 18px; margin-top: 40px;}
  .section-title { font-weight:700; font-size: 24px; color: var(--accent-2); letter-spacing:.04em; margin-bottom: 12px;}
  .watermark{position:fixed; left:50%; bottom:17px; transform:translateX(-50%); z-index:50; pointer-events:none; user-select:none; font-size:clamp(14px, 2vw, 18px); letter-spacing:.03em; font-weight:800;
    color:rgba(255,176,58,.70); text-shadow:0 0 7px rgba(255,176,58,.45),0 0 14px rgba(255,107,59,.28),0 0 1px rgba(255,236,200,.30);}
  .watermark .inner{ display:inline-block; }
  .rr-list { margin:0 0 24px 0; padding:0; list-style: none; }
  .rr-list-item { margin-bottom: 12px;}
  .rr-list-title { font-weight: 700; color: var(--accent-2);}
  .rr-blocks { margin-bottom: 10px;}
  .rr-block-main {font-weight:700;}

  /* Welcome subtitle style */
  .hero-sub{ color:#c6d0df; margin:6px 0 0 0; font-size:14px; }

  /* -------- Music player styles (bottom left persistent) -------- */
  .player {
    position: fixed;
    left: 18px;
    bottom: 12px;
    height: var(--player-height);
    min-width: 340px;
    max-width: calc(100% - 36px);
    background: linear-gradient(180deg, rgba(18,18,28,0.98), rgba(12,12,16,0.96));
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.6);
    border: 1px solid rgba(255,255,255,0.04);
    display:flex;
    gap:12px;
    align-items:center;
    padding: 8px 12px;
    z-index:10000;
    color:var(--text);
    backdrop-filter: blur(6px);
    overflow: hidden;
    font-family: inherit;
  }
  .player .left { display:flex; align-items:center; gap:10px; min-width:0; }
  .play-btn {
    width:46px; height:46px; border-radius:10px; display:inline-grid; place-items:center;
    background: linear-gradient(90deg, var(--accent-2), var(--accent));
    color:#08101a; font-weight:800; cursor:pointer; border:none; box-shadow: 0 6px 18px rgba(0,0,0,0.18);
  }
  .play-btn.paused { background: transparent; border:1px solid rgba(255,255,255,0.06); color:var(--accent-2); }
  .track-meta { min-width:0; overflow:hidden; display:flex; flex-direction:column; gap:2px; }
  .track-title { font-weight:700; font-size:14px; color: #fff; white-space:nowrap; text-overflow:ellipsis; overflow:hidden; }
  .track-sub { font-size:12px; color:var(--muted); white-space:nowrap; text-overflow:ellipsis; overflow:hidden; }

  .player .center { flex:1; display:flex; flex-direction:column; gap:6px; padding:0 8px; min-width:0; }
  .progress {
    height:6px; background: rgba(255,255,255,0.04); border-radius:6px; position:relative; cursor:pointer;
    overflow:hidden;
  }
  .progress .filled { position:absolute; left:0; top:0; bottom:0; width:0%; background: linear-gradient(90deg,var(--accent-2),var(--accent)); border-radius:6px; transition: width .12s linear; }
  .time-row { display:flex; justify-content:space-between; font-size:12px; color:var(--muted); }

  .player .right { display:flex; align-items:center; gap:8px; margin-left:8px; }
  .vol {
    display:flex; align-items:center; gap:8px;
  }
  .vol input[type=range] { width:96px; accent-color: var(--accent-2); }

  .player .small-btn {
    background: rgba(255,255,255,0.02);
    border: 1px solid rgba(255,255,255,0.03);
    color:var(--text);
    padding:8px;
    border-radius:10px;
    cursor:pointer;
  }

  @media (max-width:420px){
    .player { left: 12px; right: 12px; min-width: auto; height:56px; padding:8px; }
    .vol input[type=range] { display:none; }
    .track-sub { display:none; }
  }
  /* -------------------------------------------------------------- */

  /* Unmute fallback button (appears only if autoplay blocked) */
  .unmute {
    position: fixed;
    right: 18px;
    bottom: 18px;
    z-index:10001;
    background: linear-gradient(90deg, var(--accent-2), var(--accent));
    color:#08101a;
    padding:10px 14px;
    border-radius:12px;
    font-weight:800;
    border: none;
    display:none;
    align-items:center;
    gap:10px;
    box-shadow: 0 8px 28px rgba(0,0,0,0.45);
    cursor:pointer;
  }
  .unmute.show { display:flex; }
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>
  <div class="page-bg" aria-hidden="true"></div>

  <div class="wrap">
    <section class="hero">
      <div class="hero-inner">
        <img class="hero-logo" src="https://i.ibb.co/C3gpNWgG/RISKY-BANDS-x-LIL-QUISSY-HOT-CARS-OFFICIAL-VIDEO-EA-4-K-FILMS.gif" alt="Risky Road server logo">
        <h1 class="hero-title">
          <span class="hero-accent">Risky Road</span> Faction Showcase
        </h1>
        <p class="hero-sub">Welcome — enjoy the showcase.</p>

        <!-- Main tab navigation -->
        <nav class="nav">
          <a class="nav-link" data-tab="riskyroad" href="#"><i class="fa-solid fa-road"></i>Risky Road</a>
          <a class="nav-link" data-tab="faction" href="#"><i class="fa-solid fa-users"></i>Faction Showcase</a>
          <a class="nav-link" data-tab="activemembers" href="#"><i class="fa-solid fa-id-card"></i>Active Members</a>
        </nav>
      </div>
    </section>

    <div id="riskyroad" class="nav-section active">
      <div class="section-card">
        <div class="section-title">Risky Road</div>
        <ul class="rr-list">
          <li class="rr-list-item"><span class="rr-list-title">Set:</span> Risky Road (104th &amp; Maryland)</li>
          <li class="rr-list-item rr-blocks">
            <span class="rr-list-title">Main Block:</span> <span class="rr-block-main">104th &amp; Maryland</span>
          </li>
          <li class="rr-list-item rr-blocks">
            <span class="rr-list-title">Notable Blocks:</span> 105th &amp; Indiana &rarr; 107th &amp; Edbrooke
          </li>
          <li class="rr-list-item">
            <span class="rr-list-title">Gang Composition:</span> Predominantly composed of younger members tied to the Four Corner Hustlers (4CH) structure, guided by older OGs who’ve maintained presence in Roseland since the early 2010s. The younger generation keeps the block active through both street and social activity, while the older heads provide structure, discipline, and leadership to keep the Road organized and respected.
          </li>
          <li class="rr-list-item">
            <span class="rr-list-title">Area Formerly Controlled By:</span> Smaller 4CH-affiliated crews and independent neighborhood figures before Risky Road unified the area under the same name.
          </li>
          <li class="rr-list-item">
            <span class="rr-list-title">Neighborhood:</span> Roseland, South Side, Chicago, Illinois
          </li>
          <li class="rr-list-item">
            <span class="rr-list-title">Deceased Members:</span> Several fallen members have left their mark on the neighborhood, honored through murals, candles, and social media tributes. Their memory serves as motivation for the younger generation to keep the Road’s name alive.
          </li>
          <li class="rr-list-item">
            <span class="rr-list-title">Rappers:</span> A handful of active members have stepped into Chicago’s local drill and trap music scene, releasing songs inspired by the Road’s daily life, struggles, and neighborhood pride. Their music has built local buzz, with tracks circulating through platforms like YouTube and SoundCloud, further solidifying the set’s identity and presence online.
          </li>
          <li class="rr-list-item">
            <span class="rr-list-title">Allies:</span> Primarily aligned with other Four Corner Hustler sets across the South and West Sides. Some neutral or respectful ties with select BD and unaffiliated neighborhood crews.
          </li>
          <li class="rr-list-item">
            <span class="rr-list-title">Years Active:</span> Early 2010s – Present
          </li>
        </ul>
      </div>
    </div>

    <div id="faction" class="nav-section">
      <div class="section-card">
        <div class="section-title">Faction Showcase</div>
        <p>This section highlights the Faction Showcase for exclusive items or info. (Customize this content as needed.)</p>
      </div>
    </div>

    <div id="activemembers" class="nav-section">
      <div class="section-card">
        <div class="section-title">Active Members</div>
        <!-- Example list. Replace/add your members as needed! -->
        <ul class="rr-list">
          <li class="rr-list-item"><span class="rr-list-title">John "Lil Hawk" Smith</span> — YG, Block Runner</li>
          <li class="rr-list-item"><span class="rr-list-title">Marcus "Solo" Hayes</span> — Shooter, Main Block</li>
          <li class="rr-list-item"><span class="rr-list-title">Tony "OG Tone" Jackson</span> — OG, Faction Leader</li>
          <!-- Add other members below as needed -->
        </ul>
      </div>
    </div>

    <div class="watermark"><span class="inner">Risky Road</span></div>
  </div>

  <!-- Hidden YouTube iframe player (used as audio source) -->
  <!-- It's hidden visually but accessible to the API -->
  <div id="yt-player-wrap" style="width:0;height:0;overflow:hidden;position:fixed;left:-9999px;top:-9999px;">
    <div id="yt-player"></div>
  </div>

  <!-- Persistent music player (bottom-left) -->
  <div class="player" role="region" aria-label="Music player" id="player">
    <div class="left">
      <button id="playBtn" class="play-btn paused" aria-pressed="false" aria-label="Play">
        <i id="playIcon" class="fa-solid fa-play"></i>
      </button>
      <div class="track-meta" aria-hidden="true">
        <div class="track-title" id="trackTitle">Risky Road Showcase</div>
        <div class="track-sub" id="trackArtist">YouTube playlist</div>
      </div>
    </div>

    <div class="center">
      <div class="progress" id="progress" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" tabindex="0" aria-label="Track progress">
        <div class="filled" id="progressFilled"></div>
      </div>
      <div class="time-row">
        <div id="timeElapsed">0:00</div>
        <div id="timeTotal">0:00</div>
      </div>
    </div>

    <div class="right">
      <div class="vol" title="Volume">
        <button id="muteBtn" class="small-btn" aria-label="Mute/unmute"><i id="muteIcon" class="fa-solid fa-volume-high"></i></button>
        <input id="volRange" type="range" min="0" max="1" step="0.01" value="0.8" aria-label="Volume slider">
      </div>
      <button id="toggleLoop" class="small-btn" title="Toggle loop" aria-pressed="false"><i class="fa-solid fa-repeat"></i></button>
      <button id="nextBtn" class="small-btn" title="Next track"><i class="fa-solid fa-forward"></i></button>
      <button id="prevBtn" class="small-btn" title="Previous track"><i class="fa-solid fa-backward"></i></button>
    </div>
  </div>

  <!-- Unmute / Start fallback (shows only if autoplay blocked) -->
  <button id="unmuteBtn" class="unmute" aria-hidden="true" title="Enable music">
    <i class="fa-solid fa-volume-high"></i><span style="min-width:6ch">Play</span>
  </button>

<script>
/*
  This player uses the YouTube Iframe API as the audio source.
  Playlist (YouTube video IDs) come from the links you provided:
    - https://youtu.be/A2h-dN8fWFQ  -> id: A2h-dN8fWFQ
    - https://youtu.be/5EgOq543xH0  -> id: 5EgOq543xH0
  The UI controls the hidden YT player: play/pause, seek, volume, mute, loop, next/prev.
*/

  // Tab handler (unchanged)
  document.querySelectorAll('.nav-link').forEach(link => {
    link.addEventListener('click', e => {
      e.preventDefault();
      document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
      document.querySelectorAll('.nav-section').forEach(sec => sec.classList.remove('active'));
      link.classList.add('active');
      const tab = link.getAttribute('data-tab');
      const el = document.getElementById(tab);
      if (el) el.classList.add('active');
    });
  });

  // ---------- YouTube player setup ----------
  // Playlist: add more YouTube IDs here as needed
  const ytPlaylist = [
    { id: 'A2h-dN8fWFQ', title: 'Track 1' },
    { id: '5EgOq543xH0', title: 'Track 2' }
  ];
  let ytPlayer = null;
  let currentIndex = 0;
  let ytReady = false;
  let progressTimer = null;
  let loopCurrent = false; // toggle loop for current track

  // Load YouTube Iframe API
  (function loadYT(){
    if (window.YT && window.YT.Player) {
      onYouTubeIframeAPIReady();
      return;
    }
    const tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    document.head.appendChild(tag);
    // the API will call onYouTubeIframeAPIReady globally when loaded
  })();

  // Expose callback for API
  function onYouTubeIframeAPIReady() {
    ytPlayer = new YT.Player('yt-player', {
      height: '0', width: '0',
      videoId: ytPlaylist[currentIndex].id,
      playerVars: {
        autoplay: 0,
        controls: 0,
        modestbranding: 1,
        rel: 0,
        disablekb: 1, // we'll manage keyboard
        playsinline: 1
      },
      events: {
        'onReady': onPlayerReady,
        'onStateChange': onPlayerStateChange,
        'onError': onPlayerError
      }
    });
  }

  function onPlayerReady(event) {
    ytReady = true;
    // set initial volume from slider
    const vol = Math.round((parseFloat(document.getElementById('volRange').value) || 0.8) * 100);
    ytPlayer.setVolume(vol);
    // try to autoplay; if blocked, we'll show unmuteBtn for user to start
    tryAutoPlay();
  }

  function onPlayerError(e) {
    // console.warn('YT player error', e);
  }

  function onPlayerStateChange(event) {
    const YTSTATE = YT.PlayerState;
    if (event.data === YTSTATE.PLAYING) {
      setPlayingUI(true);
      startProgressTimer();
      hideUnmute();
    } else if (event.data === YTSTATE.PAUSED) {
      setPlayingUI(false);
      stopProgressTimer();
    } else if (event.data === YTSTATE.ENDED) {
      stopProgressTimer();
      if (loopCurrent) {
        // replay same video
        ytPlayer.seekTo(0);
        ytPlayer.playVideo();
      } else {
        // move to next in playlist
        playNext();
      }
    }
  }

  // ---------- UI helpers ----------
  const playBtn = document.getElementById('playBtn');
  const playIcon = document.getElementById('playIcon');
  const muteBtn = document.getElementById('muteBtn');
  const muteIcon = document.getElementById('muteIcon');
  const volRange = document.getElementById('volRange');
  const progress = document.getElementById('progress');
  const progressFilled = document.getElementById('progressFilled');
  const timeElapsed = document.getElementById('timeElapsed');
  const timeTotal = document.getElementById('timeTotal');
  const toggleLoop = document.getElementById('toggleLoop');
  const unmuteBtn = document.getElementById('unmuteBtn');
  const nextBtn = document.getElementById('nextBtn');
  const prevBtn = document.getElementById('prevBtn');
  const trackTitle = document.getElementById('trackTitle');
  const trackArtist = document.getElementById('trackArtist');

  function setPlayingUI(playing) {
    if (playing) {
      playBtn.classList.remove('paused');
      playIcon.className = 'fa-solid fa-pause';
      playBtn.setAttribute('aria-pressed','true');
      playBtn.setAttribute('aria-label','Pause');
    } else {
      playBtn.classList.add('paused');
      playIcon.className = 'fa-solid fa-play';
      playBtn.setAttribute('aria-pressed','false');
      playBtn.setAttribute('aria-label','Play');
    }
  }

  function formatTime(s){
    if (!isFinite(s)) return '0:00';
    s = Math.floor(s);
    const m = Math.floor(s/60);
    const sec = s % 60;
    return m + ':' + (sec < 10 ? '0'+sec : sec);
  }

  function startProgressTimer() {
    stopProgressTimer();
    progressTimer = setInterval(() => {
      if (!ytReady || !ytPlayer || typeof ytPlayer.getCurrentTime !== 'function') return;
      const cur = ytPlayer.getCurrentTime() || 0;
      const dur = ytPlayer.getDuration() || 0;
      const pct = dur ? (cur / dur) * 100 : 0;
      progressFilled.style.width = pct + '%';
      progress.setAttribute('aria-valuenow', Math.round(pct));
      timeElapsed.textContent = formatTime(cur);
      timeTotal.textContent = formatTime(dur);
    }, 400);
  }
  function stopProgressTimer() {
    if (progressTimer) { clearInterval(progressTimer); progressTimer = null; }
  }

  // ---------- Playback controls ----------
  async function tryAutoPlay() {
    if (!ytReady) return;
    // Attempt to start playback automatically
    try {
      // load initial video (so duration becomes available)
      ytPlayer.cueVideoById(ytPlaylist[currentIndex].id);
      // Attempt to play - may be blocked by browser policies
      ytPlayer.playVideo();
      // update UI after short delay
      setTimeout(()=> {
        setPlayingUI(!ytPlayer || ytPlayer.getPlayerState() === YT.PlayerState.PLAYING);
      }, 400);
    } catch (e) {
      // autoplay blocked or other error — show Unmute fallback
      showUnmute();
    }
    updateTrackMeta();
  }

  function playPauseToggle() {
    if (!ytReady) return;
    const state = ytPlayer.getPlayerState();
    if (state === YT.PlayerState.PLAYING) {
      ytPlayer.pauseVideo();
    } else {
      ytPlayer.playVideo();
    }
  }

  function playNext() {
    if (ytPlaylist.length === 0) return;
    currentIndex = (currentIndex + 1) % ytPlaylist.length;
    loadAndPlayIndex(currentIndex);
  }
  function playPrev() {
    if (ytPlaylist.length === 0) return;
    currentIndex = (currentIndex - 1 + ytPlaylist.length) % ytPlaylist.length;
    loadAndPlayIndex(currentIndex);
  }

  function loadAndPlayIndex(index) {
    if (!ytReady) return;
    const id = ytPlaylist[index].id;
    updateTrackMeta();
    try {
      // use loadVideoById to start immediately
      ytPlayer.loadVideoById(id);
    } catch (e) {
      // fallback to cue + play
      ytPlayer.cueVideoById(id);
      setTimeout(()=> ytPlayer.playVideo(), 300);
    }
  }

  function updateTrackMeta() {
    const meta = ytPlaylist[currentIndex] || {};
    trackTitle.textContent = meta.title || meta.id || 'YouTube track';
    trackArtist.textContent = `Track ${currentIndex+1} of ${ytPlaylist.length}`;
  }

  // Seek handling
  function seekFromEvent(ev) {
    if (!ytReady || !ytPlayer) return;
    const rect = progress.getBoundingClientRect();
    const x = ('touches' in ev && ev.touches && ev.touches[0]) ? ev.touches[0].clientX : ev.clientX;
    const pct = Math.max(0, Math.min(1, (x - rect.left) / rect.width));
    const dur = ytPlayer.getDuration() || 0;
    if (dur) {
      ytPlayer.seekTo(pct * dur, true);
      // update UI immediately
      progressFilled.style.width = (pct * 100) + '%';
    }
  }

  // Volume / Mute
  function setVolumeFromRange(value) {
    const vol = Math.round(parseFloat(value || 0.8) * 100);
    if (ytReady && ytPlayer && ytPlayer.setVolume) {
      ytPlayer.setVolume(vol);
      if (vol === 0) {
        muteIcon.className = 'fa-solid fa-volume-xmark';
      } else {
        muteIcon.className = 'fa-solid fa-volume-high';
      }
    }
  }
  function toggleMute() {
    if (!ytReady || !ytPlayer) return;
    if (ytPlayer.isMuted && ytPlayer.isMuted()) {
      ytPlayer.unMute();
      muteIcon.className = 'fa-solid fa-volume-high';
    } else {
      ytPlayer.mute();
      muteIcon.className = 'fa-solid fa-volume-xmark';
    }
  }

  function showUnmute() {
    unmuteBtn.classList.add('show');
    unmuteBtn.setAttribute('aria-hidden','false');
  }
  function hideUnmute() {
    unmuteBtn.classList.remove('show');
    unmuteBtn.setAttribute('aria-hidden','true');
  }

  // ---------- Wire UI events ----------
  playBtn.addEventListener('click', (e) => {
    e.preventDefault();
    if (!ytReady) {
      showUnmute();
      return;
    }
    playPauseToggle();
  });

  volRange.addEventListener('input', (e) => {
    setVolumeFromRange(e.target.value);
  });

  muteBtn.addEventListener('click', (e) => {
    e.preventDefault();
    toggleMute();
  });

  toggleLoop.addEventListener('click', (e) => {
    loopCurrent = !loopCurrent;
    toggleLoop.setAttribute('aria-pressed', String(loopCurrent));
    toggleLoop.style.opacity = loopCurrent ? '1' : '0.6';
  });

  nextBtn.addEventListener('click', (e) => { e.preventDefault(); playNext(); });
  prevBtn.addEventListener('click', (e) => { e.preventDefault(); playPrev(); });

  progress.addEventListener('click', seekFromEvent);
  progress.addEventListener('keydown', (e) => {
    if (!ytReady || !ytPlayer) return;
    const dur = ytPlayer.getDuration() || 0;
    if (!dur) return;
    const step = Math.max(5, Math.floor(dur * 0.05));
    if (e.key === 'ArrowLeft') {
      ytPlayer.seekTo(Math.max(0, ytPlayer.getCurrentTime() - step), true);
    } else if (e.key === 'ArrowRight') {
      ytPlayer.seekTo(Math.min(dur, ytPlayer.getCurrentTime() + step), true);
    }
  });

  // Spacebar to toggle play/pause when focus isn't on an input
  window.addEventListener('keydown', (e) => {
    const tag = (document.activeElement && document.activeElement.tagName) || '';
    if (e.code === 'Space' && !['INPUT','TEXTAREA','SELECT','BUTTON'].includes(tag)) {
      e.preventDefault();
      playBtn.click();
    }
  });

  // Unmute / Play fallback button (visible if autoplay was blocked)
  unmuteBtn.addEventListener('click', async (e) => {
    e.preventDefault();
    hideUnmute();
    if (!ytReady) return;
    try {
      // load the current video and request play
      ytPlayer.loadVideoById(ytPlaylist[currentIndex].id);
      ytPlayer.playVideo();
    } catch (err) {
      try { ytPlayer.playVideo(); } catch(e){}
    }
  });

  // Initialize track meta now (before YT ready)
  updateTrackMeta();

  // Keep player UI updated when playlist or state changes (safety)
  // On page unload, stop timers
  window.addEventListener('beforeunload', () => stopProgressTimer());

  // End of YouTube player integration
</script>
</body>
</html>
